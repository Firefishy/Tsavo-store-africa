<?php
// This script and data application were generated by AppGini 5.96
// Download AppGini for free from https://bigprof.com/appgini/download/

	/* Configuration */
	/*************************************/

		$pcConfig = [
			'sales' => [
				'user_id' => [
					'parent-table' => 'users',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Orders Made <span class="hidden child-label-sales child-field-caption">(Buyer id)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/bar-chart-icon.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(0 => 'Sales ID', 1 => 'Buyer id', 2 => 'Order ID', 3 => 'Sales_date', 4 => 'First_name', 5 => 'Last_name', 6 => 'Email', 7 => 'Phone', 8 => 'Address', 9 => 'Zone', 10 => 'Zone fee', 11 => 'Generated by', 12 => 'Confirmation id', 13 => 'Approval'),
					'display-field-names' => array(0 => 'id', 1 => 'user_id', 2 => 'pay_id', 3 => 'sales_day', 4 => 'first_name', 5 => 'last_name', 6 => 'email', 7 => 'phone', 8 => 'address', 9 => 'zone', 10 => 'zone_fee', 11 => 'generated_by', 12 => 'confirmation_id', 13 => 'approval'),
					'sortable-fields' => array(0 => '`sales`.`id`', 1 => '`users1`.`id`', 2 => 3, 3 => '`sales`.`sales_day`', 4 => '`users1`.`firstname`', 5 => '`users1`.`lastname`', 6 => '`users1`.`email`', 7 => '`users1`.`contact_info`', 8 => '`users1`.`address`', 9 => '`users1`.`zone`', 10 => '`users1`.`cost`', 11 => 12, 12 => 13, 13 => 14),
					'records-per-page' => 10,
					'default-sort-by' => 13,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-sales',
					'template-printable' => 'children-sales-printable',
					'query' => "SELECT `sales`.`id` as 'id', IF(    CHAR_LENGTH(`users1`.`id`), CONCAT_WS('',   `users1`.`id`), '') as 'user_id', `sales`.`pay_id` as 'pay_id', if(`sales`.`sales_day`,date_format(`sales`.`sales_day`,'%m/%d/%Y'),'') as 'sales_day', IF(    CHAR_LENGTH(`users1`.`firstname`), CONCAT_WS('',   `users1`.`firstname`), '') as 'first_name', IF(    CHAR_LENGTH(`users1`.`lastname`), CONCAT_WS('',   `users1`.`lastname`), '') as 'last_name', IF(    CHAR_LENGTH(`users1`.`email`), CONCAT_WS('',   `users1`.`email`), '') as 'email', IF(    CHAR_LENGTH(`users1`.`contact_info`), CONCAT_WS('',   `users1`.`contact_info`), '') as 'phone', IF(    CHAR_LENGTH(`users1`.`address`), CONCAT_WS('',   `users1`.`address`), '') as 'address', IF(    CHAR_LENGTH(`users1`.`zone`), CONCAT_WS('',   `users1`.`zone`), '') as 'zone', IF(    CHAR_LENGTH(`users1`.`cost`), CONCAT_WS('',   `users1`.`cost`), '') as 'zone_fee', `sales`.`generated_by` as 'generated_by', `sales`.`confirmation_id` as 'confirmation_id', `sales`.`approval` as 'approval' FROM `sales` LEFT JOIN `users` as users1 ON `users1`.`id`=`sales`.`user_id` "
				],
			],
			'products' => [
			],
			'category' => [
				'sub_cat' => [
					'parent-table' => 'sub_cat',
					'parent-primary-key' => 'sub_category',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Sub-cat Category <span class="hidden child-label-category child-field-caption">(Sub-category)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/increase-icon.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(0 => 'Id', 1 => 'Category Name', 2 => 'Main Category', 3 => 'Sub-category', 4 => 'Main Category Code', 5 => 'Category Slug'),
					'display-field-names' => array(0 => 'id', 1 => 'name', 2 => 'cat_name', 3 => 'sub_cat', 4 => 'code', 5 => 'cat_slug'),
					'sortable-fields' => array(0 => '`category`.`id`', 1 => 2, 2 => '`sub_cat_21`.`cat_name`', 3 => '`sub_cat1`.`sub_category`', 4 => '`sub_cat_21`.`code`', 5 => 6),
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-category',
					'template-printable' => 'children-category-printable',
					'query' => "SELECT `category`.`id` as 'id', `category`.`name` as 'name', IF(    CHAR_LENGTH(`sub_cat_21`.`cat_name`), CONCAT_WS('',   `sub_cat_21`.`cat_name`), '') as 'cat_name', IF(    CHAR_LENGTH(`sub_cat1`.`sub_category`), CONCAT_WS('',   `sub_cat1`.`sub_category`), '') as 'sub_cat', IF(    CHAR_LENGTH(`sub_cat_21`.`code`), CONCAT_WS('',   `sub_cat_21`.`code`), '') as 'code', `category`.`cat_slug` as 'cat_slug' FROM `category` LEFT JOIN `sub_cat_2` as sub_cat_21 ON `sub_cat_21`.`code`=`category`.`cat_name` LEFT JOIN `sub_cat` as sub_cat1 ON `sub_cat1`.`sub_category`=`category`.`sub_cat` "
				],
			],
			'supplier' => [
			],
			'users' => [
			],
			'stock' => [
				'product_name' => [
					'parent-table' => 'products',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 5,
					'tab-label' => 'Product Stock <span class="hidden child-label-stock child-field-caption">(Product name)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/Database-icon.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(0 => 'Company stock quantity', 1 => 'Product name', 2 => 'Product id', 3 => 'Supplier', 4 => 'Stock quantity'),
					'display-field-names' => array(0 => 'company_stock_quantity', 1 => 'product_name', 2 => 'product_id', 3 => 'supplier', 4 => 'stock_quantity'),
					'sortable-fields' => array(0 => '`products1`.`id`', 1 => '`products1`.`id`', 2 => '`products1`.`id`', 3 => '`products1`.`id`', 4 => '`products1`.`id`', 5 => '`stock`.`id`'),
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-stock',
					'template-printable' => 'children-stock-printable',
					'query' => "SELECT IF(    CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`id`), '') as 'company_stock_quantity', IF(    CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`id`), '') as 'product_name', IF(    CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`id`), '') as 'product_id', IF(    CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`id`), '') as 'supplier', IF(    CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`id`), '') as 'stock_quantity', `stock`.`id` as 'id' FROM `stock` LEFT JOIN `products` as products1 ON `products1`.`id`=`stock`.`product_name` "
				],
			],
			'agent' => [
			],
			'male_shoes' => [
			],
			'male_pants' => [
			],
			'male_shirts' => [
			],
			'female_shoes' => [
			],
			'female_dresses' => [
			],
			'female_skirts' => [
			],
			'female_pants' => [
			],
			'details' => [
				'sales_id' => [
					'parent-table' => 'sales',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Order Details <span class="hidden child-label-details child-field-caption">(Sales id)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/increase-icon.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Vendor Order confirmation', 2 => 'Supp name', 3 => 'Product Status', 4 => 'Sales id', 5 => 'Pay id', 6 => 'Tracking Number', 7 => 'Product id', 8 => 'Product name', 9 => 'Quantity', 10 => 'Size', 11 => 'Sales date', 12 => 'Recipient id', 13 => 'Recipient firstname', 14 => 'Recipient lastname', 15 => 'Phone info', 16 => 'Recipient Email', 17 => 'Recipient address', 18 => 'Weight', 19 => 'Length', 20 => 'Width', 21 => 'Height', 22 => 'Price', 23 => 'Pick Up Station', 24 => 'Last Edit Date ', 25 => 'Editor'),
					'display-field-names' => array(1 => 'supp_conf', 2 => 'supp_name', 3 => 'details', 4 => 'sales_id', 5 => 'payy_id', 6 => 'reference_number', 7 => 'product_id', 8 => 'product_name', 9 => 'quantity', 10 => 'size', 11 => 'sales_date', 12 => 'user_id', 13 => 'recipient_fname', 14 => 'recipient_lname', 15 => 'recipient_contact', 16 => 'recipient_email', 17 => 'recipient_address', 18 => 'weight', 19 => 'length', 20 => 'width', 21 => 'height', 22 => 'price', 23 => 'pus', 24 => 'last_edit', 25 => 'editor'),
					'sortable-fields' => array(0 => '`details`.`id`', 1 => 2, 2 => 3, 3 => 4, 4 => '`sales1`.`id`', 5 => '`sales1`.`pay_id`', 6 => 7, 7 => '`products1`.`id`', 8 => 9, 9 => '`details`.`quantity`', 10 => '`products1`.`id`', 11 => '`details`.`sales_date`', 12 => '`details`.`user_id`', 13 => 14, 14 => 15, 15 => 16, 16 => 17, 17 => 18, 18 => 19, 19 => 20, 20 => 21, 21 => 22, 22 => 23, 23 => 24, 24 => 25, 25 => 26, 26 => '`details`.`conf_id`', 27 => '`details`.`from_branch_id`', 28 => '`details`.`to_branch_id`', 29 => '`details`.`type`', 30 => 31, 31 => 32),
					'records-per-page' => 10,
					'default-sort-by' => 0,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-details',
					'template-printable' => 'children-details-printable',
					'query' => "SELECT `details`.`id` as 'id', `details`.`supp_conf` as 'supp_conf', IF(    CHAR_LENGTH(`products1`.`supplier`) || CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`supplier`, `products1`.`id`), '') as 'supp_name', `details`.`details` as 'details', IF(    CHAR_LENGTH(`sales1`.`id`), CONCAT_WS('',   `sales1`.`id`), '') as 'sales_id', IF(    CHAR_LENGTH(`sales1`.`pay_id`), CONCAT_WS('',   `sales1`.`pay_id`), '') as 'payy_id', `details`.`reference_number` as 'reference_number', IF(    CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`id`), '') as 'product_id', `details`.`product_name` as 'product_name', `details`.`quantity` as 'quantity', IF(    CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`id`), '') as 'size', if(`details`.`sales_date`,date_format(`details`.`sales_date`,'%m/%d/%Y'),'') as 'sales_date', `details`.`user_id` as 'user_id', `details`.`recipient_fname` as 'recipient_fname', `details`.`recipient_lname` as 'recipient_lname', `details`.`recipient_contact` as 'recipient_contact', `details`.`recipient_email` as 'recipient_email', `details`.`recipient_address` as 'recipient_address', `details`.`weight` as 'weight', `details`.`length` as 'length', `details`.`width` as 'width', `details`.`height` as 'height', `details`.`price` as 'price', `details`.`pus` as 'pus', `details`.`last_edit` as 'last_edit', `details`.`editor` as 'editor', `details`.`conf_id` as 'conf_id', `details`.`from_branch_id` as 'from_branch_id', `details`.`to_branch_id` as 'to_branch_id', `details`.`type` as 'type', `details`.`status` as 'status', `details`.`total_sales` as 'total_sales' FROM `details` LEFT JOIN `sales` as sales1 ON `sales1`.`id`=`details`.`sales_id` LEFT JOIN `products` as products1 ON `products1`.`id`=`details`.`product_id` "
				],
				'product_id' => [
					'parent-table' => 'products',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Product Order information <span class="hidden child-label-details child-field-caption">(Product id)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/increase-icon.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Vendor Order confirmation', 2 => 'Supp name', 3 => 'Product Status', 4 => 'Sales id', 5 => 'Pay id', 6 => 'Tracking Number', 7 => 'Product id', 8 => 'Product name', 9 => 'Quantity', 10 => 'Size', 11 => 'Sales date', 12 => 'Recipient id', 13 => 'Recipient firstname', 14 => 'Recipient lastname', 15 => 'Phone info', 16 => 'Recipient Email', 17 => 'Recipient address', 18 => 'Weight', 19 => 'Length', 20 => 'Width', 21 => 'Height', 22 => 'Price', 23 => 'Pick Up Station', 24 => 'Last Edit Date ', 25 => 'Editor'),
					'display-field-names' => array(1 => 'supp_conf', 2 => 'supp_name', 3 => 'details', 4 => 'sales_id', 5 => 'payy_id', 6 => 'reference_number', 7 => 'product_id', 8 => 'product_name', 9 => 'quantity', 10 => 'size', 11 => 'sales_date', 12 => 'user_id', 13 => 'recipient_fname', 14 => 'recipient_lname', 15 => 'recipient_contact', 16 => 'recipient_email', 17 => 'recipient_address', 18 => 'weight', 19 => 'length', 20 => 'width', 21 => 'height', 22 => 'price', 23 => 'pus', 24 => 'last_edit', 25 => 'editor'),
					'sortable-fields' => array(0 => '`details`.`id`', 1 => 2, 2 => 3, 3 => 4, 4 => '`sales1`.`id`', 5 => '`sales1`.`pay_id`', 6 => 7, 7 => '`products1`.`id`', 8 => 9, 9 => '`details`.`quantity`', 10 => '`products1`.`id`', 11 => '`details`.`sales_date`', 12 => '`details`.`user_id`', 13 => 14, 14 => 15, 15 => 16, 16 => 17, 17 => 18, 18 => 19, 19 => 20, 20 => 21, 21 => 22, 22 => 23, 23 => 24, 24 => 25, 25 => 26, 26 => '`details`.`conf_id`', 27 => '`details`.`from_branch_id`', 28 => '`details`.`to_branch_id`', 29 => '`details`.`type`', 30 => 31, 31 => 32),
					'records-per-page' => 10,
					'default-sort-by' => 0,
					'default-sort-direction' => 'desc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-details',
					'template-printable' => 'children-details-printable',
					'query' => "SELECT `details`.`id` as 'id', `details`.`supp_conf` as 'supp_conf', IF(    CHAR_LENGTH(`products1`.`supplier`) || CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`supplier`, `products1`.`id`), '') as 'supp_name', `details`.`details` as 'details', IF(    CHAR_LENGTH(`sales1`.`id`), CONCAT_WS('',   `sales1`.`id`), '') as 'sales_id', IF(    CHAR_LENGTH(`sales1`.`pay_id`), CONCAT_WS('',   `sales1`.`pay_id`), '') as 'payy_id', `details`.`reference_number` as 'reference_number', IF(    CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`id`), '') as 'product_id', `details`.`product_name` as 'product_name', `details`.`quantity` as 'quantity', IF(    CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`id`), '') as 'size', if(`details`.`sales_date`,date_format(`details`.`sales_date`,'%m/%d/%Y'),'') as 'sales_date', `details`.`user_id` as 'user_id', `details`.`recipient_fname` as 'recipient_fname', `details`.`recipient_lname` as 'recipient_lname', `details`.`recipient_contact` as 'recipient_contact', `details`.`recipient_email` as 'recipient_email', `details`.`recipient_address` as 'recipient_address', `details`.`weight` as 'weight', `details`.`length` as 'length', `details`.`width` as 'width', `details`.`height` as 'height', `details`.`price` as 'price', `details`.`pus` as 'pus', `details`.`last_edit` as 'last_edit', `details`.`editor` as 'editor', `details`.`conf_id` as 'conf_id', `details`.`from_branch_id` as 'from_branch_id', `details`.`to_branch_id` as 'to_branch_id', `details`.`type` as 'type', `details`.`status` as 'status', `details`.`total_sales` as 'total_sales' FROM `details` LEFT JOIN `sales` as sales1 ON `sales1`.`id`=`details`.`sales_id` LEFT JOIN `products` as products1 ON `products1`.`id`=`details`.`product_id` "
				],
			],
			'branches' => [
			],
			'agent_monitor' => [
			],
			'coupon' => [
			],
			'cart' => [
			],
			'drop_off' => [
			],
			'how_to_vendor' => [
			],
			'how_to_agent' => [
			],
			'message' => [
				'user_id' => [
					'parent-table' => 'users',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Messages <span class="hidden child-label-message child-field-caption">(User id)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/printer-icon.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'User id', 2 => 'User name', 3 => 'Subject', 4 => 'Message'),
					'display-field-names' => array(1 => 'user_id', 2 => 'user_name', 3 => 'product', 4 => 'message'),
					'sortable-fields' => array(0 => '`message`.`id`', 1 => '`users1`.`id`', 2 => 3, 3 => 4, 4 => 5),
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-message',
					'template-printable' => 'children-message-printable',
					'query' => "SELECT `message`.`id` as 'id', IF(    CHAR_LENGTH(`users1`.`id`), CONCAT_WS('',   `users1`.`id`), '') as 'user_id', IF(    CHAR_LENGTH(`users1`.`firstname`) || CHAR_LENGTH(`users1`.`lastname`), CONCAT_WS('',   `users1`.`firstname`, '  |||   ', `users1`.`lastname`), '') as 'user_name', `message`.`product` as 'product', `message`.`message` as 'message' FROM `message` LEFT JOIN `users` as users1 ON `users1`.`id`=`message`.`user_id` "
				],
			],
			'sales_monitor' => [
			],
			'wishlist' => [
				'user_id' => [
					'parent-table' => 'users',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Wishlist <span class="hidden child-label-wishlist child-field-caption">(User id)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/card_gift_2.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'User id', 2 => 'Wishlist First Name', 3 => 'Wishlist Lastname', 4 => 'Wishlist Email', 5 => 'Wishlist Phone Number', 6 => 'Product id', 7 => 'product in the Wishlist'),
					'display-field-names' => array(1 => 'user_id', 2 => 'w_fname', 3 => 'w_lname', 4 => 'w_email', 5 => 'w_pnumber', 6 => 'product_id', 7 => 'w_product'),
					'sortable-fields' => array(0 => '`wishlist`.`id`', 1 => '`users1`.`id`', 2 => '`users1`.`firstname`', 3 => '`users1`.`lastname`', 4 => '`users1`.`email`', 5 => '`users1`.`contact_info`', 6 => '`products1`.`id`', 7 => '`products1`.`name`'),
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-wishlist',
					'template-printable' => 'children-wishlist-printable',
					'query' => "SELECT `wishlist`.`id` as 'id', IF(    CHAR_LENGTH(`users1`.`id`), CONCAT_WS('',   `users1`.`id`), '') as 'user_id', IF(    CHAR_LENGTH(`users1`.`firstname`), CONCAT_WS('',   `users1`.`firstname`), '') as 'w_fname', IF(    CHAR_LENGTH(`users1`.`lastname`), CONCAT_WS('',   `users1`.`lastname`), '') as 'w_lname', IF(    CHAR_LENGTH(`users1`.`email`), CONCAT_WS('',   `users1`.`email`), '') as 'w_email', IF(    CHAR_LENGTH(`users1`.`contact_info`), CONCAT_WS('',   `users1`.`contact_info`), '') as 'w_pnumber', IF(    CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`id`), '') as 'product_id', IF(    CHAR_LENGTH(`products1`.`name`), CONCAT_WS('',   `products1`.`name`), '') as 'w_product' FROM `wishlist` LEFT JOIN `users` as users1 ON `users1`.`id`=`wishlist`.`user_id` LEFT JOIN `products` as products1 ON `products1`.`id`=`wishlist`.`product_id` "
				],
				'product_id' => [
					'parent-table' => 'products',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'id',
					'child-primary-key-index' => 0,
					'tab-label' => 'Wishes made <span class="hidden child-label-wishlist child-field-caption">(Product id)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/card_gift_2.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'User id', 2 => 'Wishlist First Name', 3 => 'Wishlist Lastname', 4 => 'Wishlist Email', 5 => 'Wishlist Phone Number', 6 => 'Product id', 7 => 'product in the Wishlist'),
					'display-field-names' => array(1 => 'user_id', 2 => 'w_fname', 3 => 'w_lname', 4 => 'w_email', 5 => 'w_pnumber', 6 => 'product_id', 7 => 'w_product'),
					'sortable-fields' => array(0 => '`wishlist`.`id`', 1 => '`users1`.`id`', 2 => '`users1`.`firstname`', 3 => '`users1`.`lastname`', 4 => '`users1`.`email`', 5 => '`users1`.`contact_info`', 6 => '`products1`.`id`', 7 => '`products1`.`name`'),
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-wishlist',
					'template-printable' => 'children-wishlist-printable',
					'query' => "SELECT `wishlist`.`id` as 'id', IF(    CHAR_LENGTH(`users1`.`id`), CONCAT_WS('',   `users1`.`id`), '') as 'user_id', IF(    CHAR_LENGTH(`users1`.`firstname`), CONCAT_WS('',   `users1`.`firstname`), '') as 'w_fname', IF(    CHAR_LENGTH(`users1`.`lastname`), CONCAT_WS('',   `users1`.`lastname`), '') as 'w_lname', IF(    CHAR_LENGTH(`users1`.`email`), CONCAT_WS('',   `users1`.`email`), '') as 'w_email', IF(    CHAR_LENGTH(`users1`.`contact_info`), CONCAT_WS('',   `users1`.`contact_info`), '') as 'w_pnumber', IF(    CHAR_LENGTH(`products1`.`id`), CONCAT_WS('',   `products1`.`id`), '') as 'product_id', IF(    CHAR_LENGTH(`products1`.`name`), CONCAT_WS('',   `products1`.`name`), '') as 'w_product' FROM `wishlist` LEFT JOIN `users` as users1 ON `users1`.`id`=`wishlist`.`user_id` LEFT JOIN `products` as products1 ON `products1`.`id`=`wishlist`.`product_id` "
				],
			],
			'sub_cat' => [
			],
			'item_rating' => [
				'userId' => [
					'parent-table' => 'users',
					'parent-primary-key' => 'id',
					'child-primary-key' => 'ratingId',
					'child-primary-key-index' => 0,
					'tab-label' => 'Ratings made <span class="hidden child-label-item_rating child-field-caption">(Rater id)</span>',
					'auto-close' => true,
					'table-icon' => 'resources/table_icons/award_star_gold_1.png',
					'display-refresh' => true,
					'display-add-new' => true,
					'forced-where' => '',
					'display-fields' => array(1 => 'Item Slug code', 2 => 'Rater id', 3 => 'Rater name', 4 => 'Rated stars', 5 => 'Items', 6 => 'Comments', 7 => 'Rated On'),
					'display-field-names' => array(1 => 'itemId', 2 => 'userId', 3 => 'rater_name', 4 => 'ratingNumber', 5 => 'title', 6 => 'comments', 7 => 'created'),
					'sortable-fields' => array(0 => '`item_rating`.`ratingId`', 1 => '`item_rating`.`itemId`', 2 => '`users1`.`id`', 3 => 4, 4 => 5, 5 => 6, 6 => 7, 7 => 8),
					'records-per-page' => 10,
					'default-sort-by' => false,
					'default-sort-direction' => 'asc',
					'open-detail-view-on-click' => true,
					'display-page-selector' => true,
					'show-page-progress' => true,
					'template' => 'children-item_rating',
					'template-printable' => 'children-item_rating-printable',
					'query' => "SELECT `item_rating`.`ratingId` as 'ratingId', `item_rating`.`itemId` as 'itemId', IF(    CHAR_LENGTH(`users1`.`id`), CONCAT_WS('',   `users1`.`id`), '') as 'userId', IF(    CHAR_LENGTH(`users1`.`firstname`) || CHAR_LENGTH(`users1`.`lastname`), CONCAT_WS('',   `users1`.`firstname`, '--', `users1`.`lastname`), '') as 'rater_name', `item_rating`.`ratingNumber` as 'ratingNumber', `item_rating`.`title` as 'title', `item_rating`.`comments` as 'comments', `item_rating`.`created` as 'created' FROM `item_rating` LEFT JOIN `users` as users1 ON `users1`.`id`=`item_rating`.`userId` "
				],
			],
			'followers' => [
			],
			'sub_cat_2' => [
			],
		];

	/*************************************/
	/* End of configuration */


	$currDir = dirname(__FILE__);
	include_once("{$currDir}/lib.php");
	@header('Content-Type: text/html; charset=' . datalist_db_encoding);

	handle_maintenance();

	/**
	* dynamic configuration based on current user's permissions
	* $userPCConfig array is populated only with parent tables where the user has access to
	* at least one child table
	*/
	$userPCConfig = [];
	foreach($pcConfig as $pcChildTable => $ChildrenLookups) {
		$permChild = getTablePermissions($pcChildTable);
		if(!$permChild['view']) continue;

		foreach($ChildrenLookups as $ChildLookupField => $ChildConfig) {
			$permParent = getTablePermissions($ChildConfig['parent-table']);
			if(!$permParent['view']) continue;

			$userPCConfig[$pcChildTable][$ChildLookupField] = $pcConfig[$pcChildTable][$ChildLookupField];
			// show add new only if configured above AND the user has insert permission
			$userPCConfig[$pcChildTable][$ChildLookupField]['display-add-new'] = ($permChild['insert'] && $pcConfig[$pcChildTable][$ChildLookupField]['display-add-new']);
		}
	}

	/* Receive, UTF-convert, and validate parameters */
	$ParentTable = $_REQUEST['ParentTable']; // needed only with operation=show-children, will be validated in the processing code
	$ChildTable = $_REQUEST['ChildTable'];
		if(!in_array($ChildTable, array_keys($userPCConfig))) {
			/* defaults to first child table in config array if not provided */
			$ChildTable = current(array_keys($userPCConfig));
		}
		if(!$ChildTable) { die('<!-- No tables accessible to current user -->'); }
	$SelectedID = strip_tags($_REQUEST['SelectedID']);
	$ChildLookupField = $_REQUEST['ChildLookupField'];
		if(!in_array($ChildLookupField, array_keys($userPCConfig[$ChildTable]))) {
			/* defaults to first lookup in current child config array if not provided */
			$ChildLookupField = current(array_keys($userPCConfig[$ChildTable]));
		}
	$Page = intval($_REQUEST['Page']);
		if($Page < 1) {
			$Page = 1;
		}
	$SortBy = ($_REQUEST['SortBy'] != '' ? abs(intval($_REQUEST['SortBy'])) : false);
		if(!in_array($SortBy, array_keys($userPCConfig[$ChildTable][$ChildLookupField]['sortable-fields']), true)) {
			$SortBy = $userPCConfig[$ChildTable][$ChildLookupField]['default-sort-by'];
		}
	$SortDirection = strtolower($_REQUEST['SortDirection']);
		if(!in_array($SortDirection, array('asc', 'desc'))) {
			$SortDirection = $userPCConfig[$ChildTable][$ChildLookupField]['default-sort-direction'];
		}
	$Operation = strtolower($_REQUEST['Operation']);
		if(!in_array($Operation, array('get-records', 'show-children', 'get-records-printable', 'show-children-printable'))) {
			$Operation = 'get-records';
		}

	/* process requested operation */
	switch($Operation) {
		/************************************************/
		case 'show-children':
			/* populate HTML and JS content with children tabs */
			$tabLabels = $tabPanels = $tabLoaders = '';
			foreach($userPCConfig as $ChildTable => $childLookups) {
				foreach($childLookups as $ChildLookupField => $childConfig) {
					if($childConfig['parent-table'] == $ParentTable) {
						$TableIcon = ($childConfig['table-icon'] ? "<img src=\"{$childConfig['table-icon']}\" border=\"0\">" : '');
						$tabLabels .= sprintf('<li class="child-tab-label child-table-%s lookup-field-%s %s"><a href="#panel_%s-%s" id="tab_%s-%s" data-toggle="tab">%s%s</a></li>' . "\n\t\t\t\t\t", $ChildTable, $ChildLookupField, ($tabLabels ? '' : 'active'), $ChildTable, $ChildLookupField, $ChildTable, $ChildLookupField, $TableIcon, $childConfig['tab-label']);
						$tabPanels .= sprintf('<div id="panel_%s-%s" class="tab-pane%s"><i class="glyphicon glyphicon-refresh loop-rotate"></i> %s</div>' . "\n\t\t\t\t", $ChildTable, $ChildLookupField, ($tabPanels ? '' : ' active'), $Translation['Loading ...']);
						$tabLoaders .= sprintf('post("parent-children.php", { ChildTable: "%s", ChildLookupField: "%s", SelectedID: "%s", Page: 1, SortBy: "", SortDirection: "", Operation: "get-records" }, "panel_%s-%s");' . "\n\t\t\t\t", $ChildTable, $ChildLookupField, addslashes($SelectedID), $ChildTable, $ChildLookupField);
					}
				}
			}

			if(!$tabLabels) { die('<!-- no children of current parent table are accessible to current user -->'); }
			?>
			<div id="children-tabs">
				<ul class="nav nav-tabs">
					<?php echo $tabLabels; ?>
				</ul>
				<span id="pc-loading"></span>
			</div>
			<div class="tab-content"><?php echo $tabPanels; ?></div>

			<script>
				$j(function() {
					/* for iOS, avoid loading child tabs in modals */
					var iOS = /(iPad|iPhone|iPod)/g.test(navigator.userAgent);
					var embedded = ($j('.navbar').length == 0);
					if(iOS && embedded) {
						$j('#children-tabs').next('.tab-content').remove();
						$j('#children-tabs').remove();
						return;
					}

					/* ajax loading of each tab's contents */
					<?php echo $tabLoaders; ?>

					/* show child field caption on tab title in case the same child table appears more than once */
					$j('.child-field-caption').each(function() {
						var clss = $j(this).attr('class').split(/\s+/).reduce(function(rc, cc) {
							return (cc.match(/child-label-.*/) ? '.' + cc : rc);
						}, '');

						// if class occurs more than once, remove .hidden
						if($j(clss).length > 1) $j(clss).removeClass('hidden');
					})
				})
			</script>
			<?php
			break;

		/************************************************/
		case 'show-children-printable':
			/* populate HTML and JS content with children buttons */
			$tabLabels = $tabPanels = $tabLoaders = '';
			foreach($userPCConfig as $ChildTable => $childLookups) {
				foreach($childLookups as $ChildLookupField => $childConfig) {
					if($childConfig['parent-table'] == $ParentTable) {
						$TableIcon = ($childConfig['table-icon'] ? "<img src=\"{$childConfig['table-icon']}\" border=\"0\">" : '');
						$tabLabels .= sprintf('<button type="button" class="btn btn-default child-tab-print-toggler" data-target="#panel_%s-%s" id="tab_%s-%s" data-toggle="collapse">%s %s</button>' . "\n\t\t\t\t\t", $ChildTable, $ChildLookupField, $ChildTable, $ChildLookupField, $TableIcon, $childConfig['tab-label']);
						$tabPanels .= sprintf('<div id="panel_%s-%s" class="collapse child-panel-print"><i class="glyphicon glyphicon-refresh loop-rotate"></i> %s</div>' . "\n\t\t\t\t", $ChildTable, $ChildLookupField, $Translation['Loading ...']);
						$tabLoaders .= sprintf('post("parent-children.php", { ChildTable: "%s", ChildLookupField: "%s", SelectedID: "%s", Page: 1, SortBy: "", SortDirection: "", Operation: "get-records-printable" }, "panel_%s-%s");' . "\n\t\t\t\t", $ChildTable, $ChildLookupField, addslashes($SelectedID), $ChildTable, $ChildLookupField);
					}
				}
			}

			if(!$tabLabels) { die('<!-- no children of current parent table are accessible to current user -->'); }
			?>
			<div id="children-tabs" class="hidden-print">
				<div class="btn-group btn-group-lg">
					<?php echo $tabLabels; ?>
				</div>
				<span id="pc-loading"></span>
			</div>
			<div class="vspacer-lg"><?php echo $tabPanels; ?></div>

			<script>
				$j(function() {
					/* for iOS, avoid loading child tabs in modals */
					var iOS = /(iPad|iPhone|iPod)/g.test(navigator.userAgent);
					var embedded = ($j('.navbar').length == 0);
					if(iOS && embedded) {
						$j('#children-tabs').next('.tab-content').remove();
						$j('#children-tabs').remove();
						return;
					}

					/* ajax loading of each tab's contents */
					<?php echo $tabLoaders; ?>
				})
			</script>
			<?php
			break;

		/************************************************/
		case 'get-records-printable':
		default: /* default is 'get-records' */

			if($Operation == 'get-records-printable') {
				$userPCConfig[$ChildTable][$ChildLookupField]['records-per-page'] = 2000;
			}

			// build the user permissions limiter
			$permissionsWhere = $permissionsJoin = '';
			$permChild = getTablePermissions($ChildTable);
			if($permChild['view'] == 1) { // user can view only his own records
				$permissionsWhere = "`$ChildTable`.`{$userPCConfig[$ChildTable][$ChildLookupField]['child-primary-key']}`=`membership_userrecords`.`pkValue` AND `membership_userrecords`.`tableName`='$ChildTable' AND LCASE(`membership_userrecords`.`memberID`)='" . getLoggedMemberID() . "'";
			} elseif($permChild['view'] == 2) { // user can view only his group's records
				$permissionsWhere = "`$ChildTable`.`{$userPCConfig[$ChildTable][$ChildLookupField]['child-primary-key']}`=`membership_userrecords`.`pkValue` AND `membership_userrecords`.`tableName`='$ChildTable' AND `membership_userrecords`.`groupID`='" . getLoggedGroupID() . "'";
			} elseif($permChild['view'] == 3) { // user can view all records
				/* that's the only case remaining ... no need to modify the query in this case */
			}
			$permissionsJoin = ($permissionsWhere ? ", `membership_userrecords`" : '');

			// build the count query
			$forcedWhere = $userPCConfig[$ChildTable][$ChildLookupField]['forced-where'];
			$query = 
				preg_replace('/^select .* from /i', 'SELECT count(1) FROM ', $userPCConfig[$ChildTable][$ChildLookupField]['query']) .
				$permissionsJoin . " WHERE " .
				($permissionsWhere ? "( $permissionsWhere )" : "( 1=1 )") . " AND " .
				($forcedWhere ? "( $forcedWhere )" : "( 2=2 )") . " AND " .
				"`$ChildTable`.`$ChildLookupField`='" . makeSafe($SelectedID) . "'";
			$totalMatches = sqlValue($query);

			// make sure $Page is <= max pages
			$maxPage = ceil($totalMatches / $userPCConfig[$ChildTable][$ChildLookupField]['records-per-page']);
			if($Page > $maxPage) { $Page = $maxPage; }

			// initiate output data array
			$data = array(
				'config' => $userPCConfig[$ChildTable][$ChildLookupField],
				'parameters' => array(
					'ChildTable' => $ChildTable,
					'ChildLookupField' => $ChildLookupField,
					'SelectedID' => $SelectedID,
					'Page' => $Page,
					'SortBy' => $SortBy,
					'SortDirection' => $SortDirection,
					'Operation' => $Operation
				),
				'records' => [],
				'totalMatches' => $totalMatches
			);

			// build the data query
			if($totalMatches) { // if we have at least one record, proceed with fetching data
				$startRecord = $userPCConfig[$ChildTable][$ChildLookupField]['records-per-page'] * ($Page - 1);
				$data['query'] = 
					$userPCConfig[$ChildTable][$ChildLookupField]['query'] .
					$permissionsJoin . " WHERE " .
					($permissionsWhere ? "( $permissionsWhere )" : "( 1=1 )") . " AND " .
					($forcedWhere ? "( $forcedWhere )" : "( 2=2 )") . " AND " .
					"`$ChildTable`.`$ChildLookupField`='" . makeSafe($SelectedID) . "'" . 
					($SortBy !== false && $userPCConfig[$ChildTable][$ChildLookupField]['sortable-fields'][$SortBy] ? " ORDER BY {$userPCConfig[$ChildTable][$ChildLookupField]['sortable-fields'][$SortBy]} $SortDirection" : '') .
					" LIMIT $startRecord, {$userPCConfig[$ChildTable][$ChildLookupField]['records-per-page']}";
				$res = sql($data['query'], $eo);
				while($row = db_fetch_row($res)) {
					$data['records'][$row[$userPCConfig[$ChildTable][$ChildLookupField]['child-primary-key-index']]] = $row;
				}
			} else { // if no matching records
				$startRecord = 0;
			}

			if($Operation == 'get-records-printable') {
				$response = loadView($userPCConfig[$ChildTable][$ChildLookupField]['template-printable'], $data);
			} else {
				$response = loadView($userPCConfig[$ChildTable][$ChildLookupField]['template'], $data);
			}

			// change name space to ensure uniqueness
			$uniqueNameSpace = $ChildTable.ucfirst($ChildLookupField).'GetRecords';
			echo str_replace("{$ChildTable}GetChildrenRecordsList", $uniqueNameSpace, $response);
		/************************************************/
	}
